import { verifyDevicePublicKey } from './devicePubKey';

it('should verify a device public key extension', () => {
  const clientDataHash = 'eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiaVpzVkN6dHJEVzdEMlVfR0hDSWxZS0x3VjJiQ3NCVFJxVlFVbkpYbjlUayIsIm9yaWdpbiI6ImFuZHJvaWQ6YXBrLWtleS1oYXNoOmd4N3NxX3B4aHhocklRZEx5ZkcwcHhLd2lKN2hPazJESlE0eHZLZDQzOFEiLCJhbmRyb2lkUGFja2FnZU5hbWUiOiJjb20uZmlkby5leGFtcGxlLmZpZG8yYXBpZXhhbXBsZSJ9';
  const authDataBuffer = Buffer.from('0d75fcc563fda779db2e343eea489888758b78549d493a4fdbea1cd96aa31cc48500000000a16c6465766963655075624b6579a56364706b584da5010203262001215820991aabed9de4271a9edead8806f9dc96d6dccd0c476253a5510489ec8379be5b225820a0973cfdedbb79e27fef4ee7481673fb3312504ddca5434cfd23431d6ad29eda6373696758473045022049526cd28aef6b4e621a7d5936d2b504952fc0ae2313a4f0357aafffaea964740221009d513acaefb0b32c765aae6feba8c294685eff63ff1cbf11ecf2107af4feb8f8656e6f6e6365406573636f706541006661616775696450b93fd961f2e6462fb12282002247de78', 'hex');
  const encodedSignature = 'MEUCIElSbNKK72tOYhp9WTbStQSVL8CuIxOk8DV6r_-uqWR0AiEAnVE6yu-wsyx2Wq5v66jClGhe_2P_HL8R7PIQevT-uPg';
  const publicKey = Buffer.from('A5010203262001215820991AABED9DE4271A9EDEAD8806F9DC96D6DCCD0C476253A5510489EC8379BE5B225820A0973CFDEDBB79E27FEF4EE7481673FB3312504DDCA5434CFD23431D6AD29EDA', 'hex');
  
  const result = verifyDevicePublicKey(clientDataHash, authDataBuffer, publicKey, encodedSignature);
  expect(result).toEqual(true);
});
